<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="geoarrow">
<title>Getting started with geoarrow • geoarrow</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with geoarrow">
<meta property="og:description" content="geoarrow">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">geoarrow</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/geoarrow.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/development.html">C and C++ development guide</a>
    <a class="dropdown-item" href="../articles/format.html">Geometry storage formats in geoarrow</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="geoarrow_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Getting started with geoarrow</h1>
            
      
      
      <div class="d-none name"><code>geoarrow.Rmd</code></div>
    </div>

    
    
<p>One of the motivators to writing geoarrow was to leverage the features of the <a href="https://arrow.apache.org/docs/r/" class="external-link">arrow</a> package and larger <a href="https://arrow.apache.org/" class="external-link">Apache Arrow</a> ecosystem for bigger-than-memory data sets. In the arrow package, these are exposed as <code>Dataset</code> objects and can be created from one or more files using <code><a href="https://arrow.apache.org/docs/r/reference/open_dataset.html" class="external-link">arrow::open_dataset()</a></code>. There is <a href="https://arrow.apache.org/docs/r/articles/dataset.html" class="external-link">an excellent introduction to using Datasets with dplyr</a> in the arrow package documentation that goes into detail, but the gist of it is that you can use <code><a href="https://arrow.apache.org/docs/r/reference/open_dataset.html" class="external-link">arrow::open_dataset()</a></code> to open a bigger-than-memory collection of files and query it using the familiar <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">dplyr::summarise()</a></code>, and <code><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">dplyr::arrange()</a></code>.</p>
<div class="section level2">
<h2 id="opening-a-dataset">Opening a dataset<a class="anchor" aria-label="anchor" href="#opening-a-dataset"></a>
</h2>
<p>The geoarrow package provides a few functions simplify using <code><a href="https://arrow.apache.org/docs/r/reference/write_dataset.html" class="external-link">write_dataset()</a></code> and <code><a href="https://arrow.apache.org/docs/r/reference/open_dataset.html" class="external-link">open_dataset()</a></code> with datasets that contain geospatial data encoded as one or more columns. We’ll use the arrow package, the dplyr package, and geoarrow. The geoarrow package includes a small test dataset of places in Denmark derived from <a href="https://openstreetmap.org" class="external-link">OpenStreetMap</a> and processed by <a href="https://download.geofabrik.de/europe/denmark.html" class="external-link">GeoFabrik</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/apache/arrow/" class="external-link">arrow</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paleolimbot.github.io/geoarrow/">geoarrow</a></span><span class="op">)</span>

<span class="va">places_folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"example_dataset/osm_places"</span>, package <span class="op">=</span> <span class="st">"geoarrow"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">places_folder</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; [1] "fclass=city/part-0.parquet"            </span>
<span class="co">#&gt; [2] "fclass=farm/part-0.parquet"            </span>
<span class="co">#&gt; [3] "fclass=hamlet/part-0.parquet"          </span>
<span class="co">#&gt; [4] "fclass=island/part-0.parquet"          </span>
<span class="co">#&gt; [5] "fclass=locality/part-0.parquet"        </span>
<span class="co">#&gt; [6] "fclass=national_capital/part-0.parquet"</span>
<span class="co">#&gt; [7] "fclass=suburb/part-0.parquet"          </span>
<span class="co">#&gt; [8] "fclass=town/part-0.parquet"            </span>
<span class="co">#&gt; [9] "fclass=village/part-0.parquet"</span></code></pre></div>
<p>These files were written using <code><a href="https://arrow.apache.org/docs/r/reference/write_dataset.html" class="external-link">arrow::write_dataset()</a></code> and have hive-style partitioning (i.e., the folder name provides some information about the value of a certain field for files within that folder).</p>
<p>You can preview a dataset using <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">head()</a></code> and <code><a href="../reference/read_geoparquet.html">geoarrow_collect_sf()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">places</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://arrow.apache.org/docs/r/reference/open_dataset.html" class="external-link">open_dataset</a></span><span class="op">(</span><span class="va">places_folder</span><span class="op">)</span>
<span class="va">places</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/read_geoparquet.html">geoarrow_collect_sf</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 6 features and 5 fields</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: 8.452075 ymin: 55.46649 xmax: 12.08192 ymax: 56.46175</span>
<span class="co">#&gt; Geodetic CRS:  WGS 84</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span>
<span class="co">#&gt;   osm_id    code population name     fclass            geometry</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 21040334  <span style="text-decoration: underline;">1</span>001      <span style="text-decoration: underline;">50</span>781 Roskilde city   (12.08192 55.64335)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 21040360  <span style="text-decoration: underline;">1</span>001      <span style="text-decoration: underline;">72</span>398 Esbjerg  city   (8.452075 55.46649)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 26559154  <span style="text-decoration: underline;">1</span>001      <span style="text-decoration: underline;">62</span>687 Randers  city   (10.03715 56.46175)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 26559170  <span style="text-decoration: underline;">1</span>001      <span style="text-decoration: underline;">60</span>508 Kolding  city     (9.47905 55.4895)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 26559198  <span style="text-decoration: underline;">1</span>001      <span style="text-decoration: underline;">56</span>567 Vejle    city   (9.533324 55.70001)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 26559213  <span style="text-decoration: underline;">1</span>001     <span style="text-decoration: underline;">273</span>077 Aarhus   city    (10.2134 56.14963)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="querying-a-data-set">Querying a data set<a class="anchor" aria-label="anchor" href="#querying-a-data-set"></a>
</h2>
<p>Just like a local data frame, you can use dplyr verbs like <code>fiilter()</code>, <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise()</a></code> to subset and manipulate the data before it is pulled into the R session. For example, to find all the places in Denmark with a population greater than 100,000 people, we can do this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">places</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">population</span> <span class="op">&gt;</span> <span class="fl">100000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">population</span>, <span class="va">fclass</span>, <span class="va">geometry</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/read_geoparquet.html">geoarrow_collect_sf</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 5 features and 3 fields</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: 9.921526 ymin: 55.39972 xmax: 12.57007 ymax: 57.04626</span>
<span class="co">#&gt; Geodetic CRS:  WGS 84</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span>
<span class="co">#&gt;   name          population fclass                      geometry</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Aarhus            <span style="text-decoration: underline;">273</span>077 city              (10.2134 56.14963)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Odense            <span style="text-decoration: underline;">178</span>210 city             (10.38521 55.39972)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Aalborg           <span style="text-decoration: underline;">114</span>194 city             (9.921526 57.04626)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Frederiksberg     <span style="text-decoration: underline;">102</span>029 suburb           (12.53262 55.67802)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> København         <span style="text-decoration: underline;">613</span>288 national_capital (12.57007 55.68672)</span></code></pre></div>
<p>Geometry operators aren’t yet supported within the Arrow compute engine, so any filtering or transformation on geometry columns must be done at the beginning (i.e., when selecting files to pass to <code><a href="https://arrow.apache.org/docs/r/reference/open_dataset.html" class="external-link">open_dataset()</a></code>) or at the end (i.e., after calling <code><a href="../reference/read_geoparquet.html">geoarrow_collect_sf()</a></code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">capital</span> <span class="op">&lt;-</span> <span class="va">places</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">==</span> <span class="st">"København"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/read_geoparquet.html">geoarrow_collect_sf</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># cities within 200 km of the capital</span>
<span class="va">places</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fclass</span> <span class="op">==</span> <span class="st">"city"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/read_geoparquet.html">geoarrow_collect_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span>
    <span class="fu">s2</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/s2/reference/s2_contains.html" class="external-link">s2_dwithin</a></span><span class="op">(</span><span class="va">geometry</span>, <span class="va">capital</span>, <span class="fl">200000</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 7 features and 5 fields</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: 9.47905 ymin: 55.39972 xmax: 12.08192 ymax: 56.46175</span>
<span class="co">#&gt; Geodetic CRS:  WGS 84</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 6</span></span>
<span class="co">#&gt;   osm_id      code population name     fclass            geometry</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;POINT [°]&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 21040334    <span style="text-decoration: underline;">1</span>001      <span style="text-decoration: underline;">50</span>781 Roskilde city   (12.08192 55.64335)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 26559154    <span style="text-decoration: underline;">1</span>001      <span style="text-decoration: underline;">62</span>687 Randers  city   (10.03715 56.46175)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 26559170    <span style="text-decoration: underline;">1</span>001      <span style="text-decoration: underline;">60</span>508 Kolding  city     (9.47905 55.4895)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 26559198    <span style="text-decoration: underline;">1</span>001      <span style="text-decoration: underline;">56</span>567 Vejle    city   (9.533324 55.70001)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 26559213    <span style="text-decoration: underline;">1</span>001     <span style="text-decoration: underline;">273</span>077 Aarhus   city    (10.2134 56.14963)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 26559274    <span style="text-decoration: underline;">1</span>001     <span style="text-decoration: underline;">178</span>210 Odense   city   (10.38521 55.39972)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">7</span> 1368129781  <span style="text-decoration: underline;">1</span>001      <span style="text-decoration: underline;">58</span>646 Horsens  city   (9.844477 55.86117)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-geoarrow_collect">Using <code>geoarrow_collect()</code><a class="anchor" aria-label="anchor" href="#using-geoarrow_collect"></a>
</h2>
<p>Until this point, we have used <code><a href="../reference/read_geoparquet.html">geoarrow_collect_sf()</a></code>. This is probably what you want, since the fantastic <a href="https://r-spatial.github.io/sf/" class="external-link">sf</a> package is a feature-complete GIS designed to work well with GIS data in data.frame form. If you want to customize how geometry columns are converted into R objects, you can use <code><a href="../reference/read_geoparquet.html">geoarrow_collect()</a></code> with a <code>handler</code>. For example, if you want to convert geometry to a <code><a href="https://paleolimbot.github.io/wk/reference/wkb.html" class="external-link">wk::wkb()</a></code> directly without pivoting through sf, you can use <code>handler = wk::wkb_writer</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">places</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/read_geoparquet.html">geoarrow_collect</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="fu">wk</span><span class="fu">::</span><span class="va"><a href="https://paleolimbot.github.io/wk/reference/wk_writer.html" class="external-link">wkb_writer</a></span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span>
<span class="co">#&gt;   osm_id    code population name     fclass geometry                   </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;wk_wkb&gt;</span>                   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 21040334  <span style="text-decoration: underline;">1</span>001      <span style="text-decoration: underline;">50</span>781 Roskilde city   &lt;POINT (12.08192 55.64335)&gt;</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 21040360  <span style="text-decoration: underline;">1</span>001      <span style="text-decoration: underline;">72</span>398 Esbjerg  city   &lt;POINT (8.452075 55.46649)&gt;</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 26559154  <span style="text-decoration: underline;">1</span>001      <span style="text-decoration: underline;">62</span>687 Randers  city   &lt;POINT (10.03715 56.46175)&gt;</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 26559170  <span style="text-decoration: underline;">1</span>001      <span style="text-decoration: underline;">60</span>508 Kolding  city   &lt;POINT (9.47905 55.4895)&gt;  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 26559198  <span style="text-decoration: underline;">1</span>001      <span style="text-decoration: underline;">56</span>567 Vejle    city   &lt;POINT (9.533324 55.70001)&gt;</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 26559213  <span style="text-decoration: underline;">1</span>001     <span style="text-decoration: underline;">273</span>077 Aarhus   city   &lt;POINT (10.2134 56.14963)&gt;</span></code></pre></div>
<p>For large point data sets, it can be useful to represent geometry as a <code><a href="https://paleolimbot.github.io/wk/reference/xy.html" class="external-link">wk::xy()</a></code>, which is a thin wrapper around <code>data.frame(x = c(), y = c())</code>. You can create these objects as geometry columns using <code>handler = wk::xy_writer</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">places_xy</span> <span class="op">&lt;-</span> <span class="va">places</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">geometry</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/read_geoparquet.html">geoarrow_collect</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="fu">wk</span><span class="fu">::</span><span class="va"><a href="https://paleolimbot.github.io/wk/reference/wk_writer.html" class="external-link">xy_writer</a></span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 7,255 × 2</span></span>
<span class="co">#&gt;    name           geometry            </span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;wk_xy&gt;</span>             </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Roskilde       (12.081925 55.64335)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Esbjerg        ( 8.452075 55.46649)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Randers        (10.037148 56.46175)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Kolding        ( 9.479050 55.48950)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Vejle          ( 9.533324 55.70001)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Aarhus         (10.213405 56.14963)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Odense         (10.385210 55.39972)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Horsens        ( 9.844477 55.86117)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Aalborg        ( 9.921526 57.04626)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Englebjerggård (11.777372 55.20040)</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 7,245 more rows</span></span>

<span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">places_xy</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">xy</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; [1] 12.081925  8.452075 10.037148  9.479050  9.533324 10.213405</span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dewey Dunnington.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
